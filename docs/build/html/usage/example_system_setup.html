

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Example System Setup &mdash; generate_InitCond 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Simulation Output" href="simulation_output.html" />
    <link rel="prev" title="Pipeline Overview" href="pipeline.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/Logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipeline.html">Pipeline Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Example System Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#running-the-pipeline-and-generating-initial-condition">Running the Pipeline and Generating Initial Condition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inspecting-b70-n200-l500-data">Inspecting “b70_N200_L500.data”</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inspecting-n200-rg-l500-colvars">Inspecting “N200_Rg_L500.colvars”</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inspecting-b70-n200-l500-in">Inspecting “b70_N200_L500.in”</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="simulation_output.html">Simulation Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_analysis.html">Data-Analysis Helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">generate_InitCond</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Example System Setup</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/usage/example_system_setup.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="example-system-setup">
<h1>Example System Setup<a class="headerlink" href="#example-system-setup" title="Link to this heading"></a></h1>
<p>This section walks through a complete, working example:
1. Defining a small polymer system
2. Running the pipeline to generate initial data
3. Launching a short LAMMPS simulation
4. Examining the key output files and results</p>
<section id="running-the-pipeline-and-generating-initial-condition">
<h2>Running the Pipeline and Generating Initial Condition<a class="headerlink" href="#running-the-pipeline-and-generating-initial-condition" title="Link to this heading"></a></h2>
<p>Below is a line-by-line breakdown of the key commands in <cite>create_InitCoor.sh</cite>. Each code snippet is followed by its purpose.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">n</span><span class="o">=</span><span class="m">10</span><span class="w"> </span><span class="c1"># segment count</span>
</pre></div>
</div>
<p>Sets the variable <cite>n</cite> to <cite>10</cite>, which means each polymer chain will consist of 10 repeats of the segment pattern.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">seg</span><span class="o">=</span><span class="m">2212212</span><span class="w"> </span><span class="c1"># segment pattern</span>
</pre></div>
</div>
<p>Assigns the pattern string <cite>2212212</cite> to <cite>seg</cite>. Each digit indicates whether that bead is a “sticker” (<cite>1</cite>) or a “spacer” (<cite>2</cite>).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">NA</span><span class="o">=</span><span class="m">100</span><span class="w"> </span><span class="c1"># A-chain count</span>
<span class="nv">NB</span><span class="o">=</span><span class="m">100</span><span class="w"> </span><span class="c1"># B-chain count</span>
</pre></div>
</div>
<p><cite>NA=100</cite> means we will create 100 copies of the “A” polymer, and <cite>NB=100</cite> creates 100 copies of the “B” polymer.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">L</span><span class="o">=</span><span class="m">300</span>
</pre></div>
</div>
<p>Sets the half-box length to 300 Å in each direction.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">L2</span><span class="o">=</span><span class="k">$((</span><span class="m">2</span><span class="o">*</span><span class="nv">$L</span><span class="k">))</span>
</pre></div>
</div>
<p>Defines <cite>L2 = 600</cite>, the full box length (used internally by Moltemplate’s Data Boundary).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">pck_inp</span><span class="o">=</span><span class="s1">&#39;populate_tmp.inp&#39;</span>
<span class="nv">pck_out</span><span class="o">=</span><span class="s1">&#39;IC_tmp.xyz&#39;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><cite>pck_inp=’populate_tmp.inp’</cite> is the name of the Packmol input file to be generated.</p></li>
<li><p><cite>pck_out=’IC_tmp.xyz’</cite> is the name of the XYZ file that Packmol will produce (initial coordinates for LAMMPS).</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">cvfile</span><span class="o">=</span><span class="s1">&#39;N400_Rg_L700.colvars&#39;</span>
<span class="nv">sysName</span><span class="o">=</span><span class="s2">&quot;b70_N200_L</span><span class="nv">$L</span><span class="s2">.lt&quot;</span>
<span class="nv">dataFile</span><span class="o">=</span><span class="s2">&quot;b70_N200_L</span><span class="nv">$L</span><span class="s2">.data&quot;</span>
<span class="nv">lmp_input</span><span class="o">=</span><span class="s1">&#39;Template_input.in&#39;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><cite>cvfile=’N400_Rg_L700.colvars’</cite> is the base Colvars input file used by <cite>updateColVar.py</cite>.</p></li>
<li><p><cite>sysName=”b70_N200_L$L.lt”</cite> resolves to <cite>b70_N200_L300.lt</cite>, the Moltemplate system file.</p></li>
<li><p><cite>dataFile=”b70_N200_L$L.data”</cite> resolves to <cite>b70_N200_L300.data</cite>, which Moltemplate outputs.</p></li>
<li><p><cite>lmp_input=’Template_input.in’</cite> is the LAMMPS input template that <cite>updateInput.py</cite> will read and customize.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>LT_writer.py<span class="w"> </span><span class="nv">$n</span><span class="w"> </span><span class="nv">$seg</span>
</pre></div>
</div>
<p>Runs <cite>LT_writer.py 10 2212212</cite>, generating:
- <cite>polyA_n10.lt</cite>
- <cite>polyB_n10.lt</cite>
- <cite>polyA_n10_mono.xyz</cite>
- <cite>polyB_n10_mono.xyz</cite></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>writePackmolInput.py<span class="w"> </span><span class="nv">$n</span><span class="w"> </span><span class="nv">$NA</span><span class="w"> </span><span class="nv">$NB</span><span class="w"> </span><span class="nv">$L</span><span class="w"> </span><span class="nv">$pck_inp</span><span class="w"> </span><span class="nv">$pck_out</span>
</pre></div>
</div>
<p>Invokes <cite>writePackmolInput.py 10 100 100 300 populate_tmp.inp IC_tmp.xyz</cite>. Creates <cite>populate_tmp.inp</cite> to place 100 A-chains and 100 B-chains inside a 600 Å cube.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>writeSysLT.py<span class="w"> </span><span class="nv">$n</span><span class="w"> </span><span class="nv">$NA</span><span class="w"> </span><span class="nv">$NB</span><span class="w"> </span><span class="nv">$L</span><span class="w"> </span><span class="nv">$sysName</span>
</pre></div>
</div>
<p>Runs <cite>writeSysLT.py 10 100 100 300 b70_N200_L300.lt</cite>, producing:
- <cite>b70_N200_L300.lt</cite>, which imports <cite>polyA_n10.lt</cite> and <cite>polyB_n10.lt</cite>, defines 100 copies each, and writes the boundary.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>packmol<span class="w"> </span>&lt;<span class="w"> </span><span class="nv">$pck_inp</span>
</pre></div>
</div>
<p>Feeds <cite>populate_tmp.inp</cite> into Packmol. The output is <cite>IC_tmp.xyz</cite>, the initial coordinates for all 200 polymers.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>moltemplate.sh<span class="w"> </span>-xyz<span class="w"> </span><span class="nv">$pck_out</span><span class="w"> </span><span class="nv">$sysName</span><span class="w"> </span>-nocheck
</pre></div>
</div>
<p>Runs Moltemplate on <cite>IC_tmp.xyz b70_N200_L300.lt</cite>, producing <cite>b70_N200_L300.data</cite> (the LAMMPS data file).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>updateColVar.py<span class="w"> </span><span class="nv">$pck_out</span><span class="w"> </span><span class="nv">$cvfile</span><span class="w"> </span><span class="nv">$L</span><span class="w"> </span><span class="nv">$n</span><span class="w"> </span><span class="nv">$NA</span><span class="w"> </span><span class="nv">$NB</span><span class="w"> </span><span class="nv">$seg</span>
</pre></div>
</div>
<p>Runs <cite>updateColVar.py IC_tmp.xyz N400_Rg_L700.colvars 300 10 100 100 2212212</cite>, which:
- Computes the initial R&lt;sub&gt;g&lt;/sub&gt; and box dimensions from <cite>IC_tmp.xyz</cite>.
- Writes <cite>N200_Rg_L300.colvars</cite>, updating <cite>upperBoundary</cite>, <cite>upperWalls</cite>, and <cite>atomNumbers</cite>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>updateInput.py<span class="w"> </span><span class="nv">$lmp_input</span><span class="w"> </span><span class="nv">$L</span>
</pre></div>
</div>
<p>Runs <cite>updateInput.py Template_input.in 300</cite>, which reads <cite>Template_input.in</cite> and writes:
- <cite>b70_N200_L300.in</cite>
- <cite>submit_b70_N200_L300.sh</cite>
Inserting correct filenames (e.g., <cite>read_data b70_N200_L300.data</cite>).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>fix_datafiles.py<span class="w"> </span><span class="nv">$dataFile</span>
</pre></div>
</div>
<p>Runs <cite>fix_datafiles.py b70_N200_L300.data</cite>, which:
- Changes “2 bond types” → “3 bond types”
- Inserts “50 extra bond per atom”</p>
</section>
<section id="inspecting-b70-n200-l500-data">
<h2>Inspecting “b70_N200_L500.data”<a class="headerlink" href="#inspecting-b70-n200-l500-data" title="Link to this heading"></a></h2>
<p>Below is a trimmed excerpt from <cite>b70_N200_L500.data</cite>, broken into sections.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>LAMMPS Description
</pre></div>
</div>
<p>A comment/header indicating this is a Moltemplate-generated data file.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>14000  atoms
13800  bonds
13600  angles
0  dihedrals
0  impropers
</pre></div>
</div>
<ul class="simple">
<li><p><cite>14000 atoms</cite>: total beads in the system.</p></li>
<li><p><cite>13800 bonds</cite>: total covalent bonds.</p></li>
<li><p><cite>13600 angles</cite>: total angles.</p></li>
<li><p><cite>0 dihedrals</cite> / <cite>0 impropers</cite>: none present.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>4  atom types
3  bond types
50 extra bond per atom
2  angle types
0  dihedral types
0  improper types
</pre></div>
</div>
<ul class="simple">
<li><p><cite>4 atom types</cite>: four distinct bead types (A, AL, B, BL).</p></li>
<li><p><cite>3 bond types</cite>: three bond types (one added by <cite>fix_datafiles.py</cite>).</p></li>
<li><p><cite>50 extra bond per atom</cite>: allocated by <cite>fix_datafiles.py</cite>.</p></li>
<li><p><cite>2 angle types</cite>: two unique angle parameters.</p></li>
<li><p><cite>0 dihedral types</cite> / <cite>0 improper types</cite>: none used.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-420.0 420.0 xlo xhi
-420.0 420.0 ylo yhi
-420.0 420.0 zlo zhi
</pre></div>
</div>
<p>Simulation box ranges from –420 Å to +420 Å in each dimension (since <cite>L=500</cite> plus buffer).</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Masses
</pre></div>
</div>
<p>The “Masses” section begins here.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>1 1000  # A
2 1000  # AL
3 1000  # B
4 1000  # BL
</pre></div>
</div>
<ul class="simple">
<li><p>Type 1 (A) mass = 1000 amu.</p></li>
<li><p>Type 2 (AL) mass = 1000 amu.</p></li>
<li><p>Type 3 (B) mass = 1000 amu.</p></li>
<li><p>Type 4 (BL) mass = 1000 amu.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Atoms
</pre></div>
</div>
<p>Begins atom definitions.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>1 1 2 0  71.348682 -75.514994 -53.224331
2 1 2 0  70.344153 -73.813962 -52.912221
</pre></div>
</div>
<ul class="simple">
<li><p><cite>1 1 2 0 71.348682 -75.514994 -53.224331</cite>:
- Atom ID = 1
- Molecule ID = 1
- Type = 2 (AL)
- Charge = 0
- Coordinates = (71.348682, –75.514994, –53.224331)</p></li>
</ul>
<p><em>(…continues for all 14 000 atoms…)</em></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Bonds
</pre></div>
</div>
<p>Begins bond definitions.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>1 1 1 2
2 1 2 3
3 1 3 4
</pre></div>
</div>
<ul class="simple">
<li><p><cite>1 1 1 2</cite>: Bond ID = 1, Type = 1, connects atom 1–2.</p></li>
<li><p><cite>2 1 2 3</cite>: Bond ID = 2, Type = 1, connects atom 2–3.</p></li>
<li><p><cite>3 1 3 4</cite>: Bond ID = 3, Type = 1, connects atom 3–4.</p></li>
</ul>
<p><em>(…continues for all 13 800 bonds…)</em></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Angles
</pre></div>
</div>
<p>Begins angle definitions.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>1 1 1 2 3
2 1 2 3 4
</pre></div>
</div>
<ul class="simple">
<li><p><cite>1 1 1 2 3</cite>: Angle ID = 1, Type = 1, between atoms (1, 2, 3).</p></li>
<li><p><cite>2 1 2 3 4</cite>: Angle ID = 2, Type = 1, between atoms (2, 3, 4).</p></li>
</ul>
<p><em>(…continues for all 13 600 angles…)</em></p>
</section>
<section id="inspecting-n200-rg-l500-colvars">
<h2>Inspecting “N200_Rg_L500.colvars”<a class="headerlink" href="#inspecting-n200-rg-l500-colvars" title="Link to this heading"></a></h2>
<p>Below is the full <cite>N200_Rg_L500.colvars</cite>, with each block explained.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>colvarsTrajFrequency 50000
colvarsRestartFrequency 50000
</pre></div>
</div>
<ul class="simple">
<li><p><cite>colvarsTrajFrequency 50000</cite>: Write colvar trajectory every 50 000 steps.</p></li>
<li><p><cite>colvarsRestartFrequency 50000</cite>: Write colvar restart file every 50 000 steps.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>colvar {
   name Rg1
</pre></div>
</div>
<p>Starts a colvar block named <cite>Rg1</cite>.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>lowerBoundary 0.0
upperBoundary 280
</pre></div>
</div>
<ul class="simple">
<li><p><cite>lowerBoundary 0.0</cite>: Minimum R&lt;sub&gt;g&lt;/sub&gt; value.</p></li>
<li><p><cite>upperBoundary 280</cite>: Maximum R&lt;sub&gt;g&lt;/sub&gt; value computed by <cite>updateColVar.py</cite>.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>gyration {
   atoms {
      atomNumbers {
         36 71 106 141 176 211 246 281 316 351 386 421 456 491
         526 561 596 631 666 701 736 771 806 841 876 911 946 981
         1016 1051 1086 1121 1156 1191 1226 1261 1296 1331 1366
         1401 1436 1471 1506 1541 1576 1611 1646 1681 1716 1751
         1786 1821 1856 1891 1926 1961 1996 2031 2066 2101 2136
         2171 2206 2241 2276 2311 2346 2381 2416 2451 2486 2521
         2556 2591 2626 2661 2696 2731 2766 2801 2836 2871 2906
         2941 2976 3011 3046 3081 3116 3151 3186 3221 3256 3291
         3326 3361 3396 3431 3466 3501 3536 3571 3606 3641 3676
         3711 3746 3781 3816 3851 3886 3921 3956 3991 4026 4061
         4096 4131 4166 4201 4236 4271 4306 4341 4376 4411 4446
         4481 4516 4551 4586 4621 4656 4691 4726 4761 4796 4831
         4866 4901 4936 4971 5006 5041 5076 5111 5146 5181 5216
         5251 5286 5321 5356 5391 5426 5461 5496 5531 5566 5601
         5636 5671 5706 5741 5776 5811 5846 5881 5916 5951 5986
         6021 6056 6091 6126 6161 6196 6231 6266 6301 6336 6371
         6406 6441 6476 6511 6546 6581 6616 6651 6686 6721 6756
         6791 6826 6861 6896 6931 6966 7001 7036 7071 7106 7141
         7176 7211 7246 7281 7316 7351 7386 7421 7456 7491 7526
         7561 7596 7631 7666 7701 7736 7771 7806 7841 7876 7911
         7946 7981 8016 8051 8086 8121 8156 8191 8226 8261 8296
         8331 8366 8401 8436 8471 8506 8541 8576 8611 8646 8681
         8716 8751 8786 8821 8856 8891 8926 8961 8996 9031 9066
         9101 9136 9171 9206 9241 9276 9311 9346 9381 9416 9451
         9486 9521 9556 9591 9626 9661 9696 9731 9766 9801 9836
         9871 9906 9941 9976 10011 10046 10081 10116 10151 10186
         10221 10256 10291 10326 10361 10396 10431 10466 10501
         10536 10571 10606 10641 10676 10711 10746 10781 10816
         10851 10886 10921 10956 10991 11026 11061 11096 11131
         11166 11201 11236 11271 11306 11341 11376 11411 11446
         11481 11516 11551 11586 11621 11656 11691 11726 11761
         11796 11831 11866 11901 11936 11971 12006 12041 12076
         12111 12146 12181 12216 12251 12286 12321 12356 12391
         12426 12461 12496 12531 12566 12601 12636 12671 12706
         12741 12776 12811 12846 12881 12916 12951 12986 13021
         13056 13091 13126 13161 13196 13231 13266 13301 13336
         13371 13406 13441 13476 13511 13546 13616 13651 13686
         13721 13756 13791 13826 13861 13896 13931 13966
      }
   }
}
</pre></div>
</div>
<p>Lists all atom indices used in the R&lt;sub&gt;g&lt;/sub&gt; calculation.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>metadynamics {
   name meta-radgy
   colvars Rg1
   hillWeight 0.2
   newHillFrequency 500
   dumpFreeEnergyFile yes
   writeHillsTrajectory on
   hillwidth 1.0
   wellTempered on
   biasTemperature 310
}
</pre></div>
</div>
<ul class="simple">
<li><p><cite>metadynamics {</cite>: Begins a metadynamics block.</p></li>
<li><p><cite>name meta-radgy</cite>: Names the bias “meta-radgy.”</p></li>
<li><p><cite>colvars Rg1</cite>: Applies metadynamics on <cite>Rg1</cite>.</p></li>
<li><p><cite>hillWeight 0.2</cite>: Gaussian hill height = 0.2 kcal/mol.</p></li>
<li><p><cite>newHillFrequency 500</cite>: New hill every 500 steps.</p></li>
<li><p><cite>dumpFreeEnergyFile yes</cite>: Write free‐energy profile.</p></li>
<li><p><cite>writeHillsTrajectory on</cite>: Save hill history.</p></li>
<li><p><cite>hillwidth 1.0</cite>: Gaussian width = 1 Å.</p></li>
<li><p><cite>wellTempered on</cite>: Enable well-tempered MD.</p></li>
<li><p><cite>biasTemperature 310</cite>: Bias temperature = 310 K.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>harmonicWalls {
   name wall_Rg
   colvars Rg1
   upperWalls 275
   upperWallConstant 20.0
}
</pre></div>
</div>
<ul class="simple">
<li><p><cite>harmonicWalls {</cite>: Begins a harmonic-walls block.</p></li>
<li><p><cite>name wall_Rg</cite>: Names this constraint “wall_Rg.”</p></li>
<li><p><cite>colvars Rg1</cite>: Applies the wall to colvar <cite>Rg1</cite>.</p></li>
<li><p><cite>upperWalls 275</cite>: Place a hard wall at R&lt;sub&gt;g&lt;/sub&gt; = 275 Å.</p></li>
<li><p><cite>upperWallConstant 20.0</cite>: Wall force constant = 20 kcal/mol/Å².</p></li>
</ul>
</section>
<section id="inspecting-b70-n200-l500-in">
<h2>Inspecting “b70_N200_L500.in”<a class="headerlink" href="#inspecting-b70-n200-l500-in" title="Link to this heading"></a></h2>
<p>Below is the LAMMPS input file, split into logical blocks with explanations.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>variable T equal 310
</pre></div>
</div>
<p>Defines LAMMPS variable <cite>T</cite> (temperature) = 310 K.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>variable seed equal 14327
</pre></div>
</div>
<p>Sets the random seed for Langevin dynamics and bond creation = 14327.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>variable fName string b70_N200_L300
</pre></div>
</div>
<p>Defines <cite>fName</cite> = “b70_N200_L300”, used to name log, data, and output files.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>log ${fName}.log
</pre></div>
</div>
<p>Directs LAMMPS console output into <cite>b70_N200_L300.log</cite>.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>units           real
boundary p p p
atom_style      full
</pre></div>
</div>
<ul class="simple">
<li><p><cite>units real</cite>: Use real-units (Å, fs, kcal/mol).</p></li>
<li><p><cite>boundary p p p</cite>: Periodic boundary in x, y, z.</p></li>
<li><p><cite>atom_style full</cite>: Each atom has charge, bonds, angles, etc.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>neighbor 1.9 bin
neigh_modify every 1 delay 1 check yes
</pre></div>
</div>
<ul class="simple">
<li><p><cite>neighbor 1.9 bin</cite>: Build neighbor list with 1.9 Å skin, bin‐sorting.</p></li>
<li><p><cite>neigh_modify every 1 delay 1 check yes</cite>: Update neighbor list every step, no delay.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>read_data b70_N200_L300.data extra/special/per/atom 50
</pre></div>
</div>
<p>Reads the data file <cite>b70_N200_L300.data</cite>, allowing 50 special bond tags per atom.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>angle_style  cosine
angle_coeff   *  2  # K (energy unit)
</pre></div>
</div>
<ul class="simple">
<li><p><cite>angle_style cosine</cite>: Use a cosine-based angle potential.</p></li>
<li><p><cite>angle_coeff * 2</cite>: Force constant K = 2 for all angle types.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>bond_style   hybrid harmonic harmonic/shift/cut
bond_coeff   1   harmonic 3   10
bond_coeff   2   harmonic 3   10
bond_coeff   3   harmonic/shift/cut 6   11.22   12.72
</pre></div>
</div>
<ul class="simple">
<li><p><cite>bond_style hybrid harmonic harmonic/shift/cut</cite>: Use hybrid bond potentials.</p></li>
<li><p><cite>bond_coeff 1 harmonic 3 10</cite>: Type 1 bonds: K = 3, length = 10 Å.</p></li>
<li><p><cite>bond_coeff 2 harmonic 3 10</cite>: Type 2 bonds: K = 3, length = 10 Å.</p></li>
<li><p><cite>bond_coeff 3 harmonic/shift/cut 6 11.22 12.72</cite>: Type 3 bonds: K = 6, eq = 11.22 Å, cutoff = 12.72 Å.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pair_style lj/cut 25
pair_coeff * * 0.3 10 25
</pre></div>
</div>
<ul class="simple">
<li><p><cite>pair_style lj/cut 25</cite>: Lennard-Jones with 25 Å cutoff.</p></li>
<li><p><cite>pair_coeff * * 0.3 10 25</cite>: For all pairs, ε = 0.3 kcal/mol, σ = 10 Å, cutoff = 25 Å.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>special_bonds lj 1 1 1 angle no
</pre></div>
</div>
<p>Use full LJ (no scaling) for 1–2, 1–3, 1–4 neighbors, without excluding LJ for angles.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>minimize 1.0e-4 1.0e-6 100000 100000 # force_tol, energy_tol, maxiter, maxeval
</pre></div>
</div>
<ul class="simple">
<li><p>Minimize with:
- Force tol = 1×10⁻⁴ kcal/mol·Å
- Energy tol = 1×10⁻⁶ kcal/mol
- Max iterations = 100 000
- Max energy evaluations = 100 000</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># further equilibrate the system before bond formation takes place
fix fxlan all langevin $T $T 500 ${seed}
fix fxnve all nve
timestep 0.1
run 10000
</pre></div>
</div>
<ul class="simple">
<li><p><cite>fix fxlan all langevin $T $T 500 ${seed}</cite>: Langevin thermostat at 310 K, damping = 500 fs, seed = 14327.</p></li>
<li><p><cite>fix fxnve all nve</cite>: NVE integration combined with Langevin.</p></li>
<li><p><cite>timestep 0.1</cite>: 0.1 fs timestep.</p></li>
<li><p><cite>run 10000</cite>: Run 10 000 steps to equilibrate.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>unfix fxlan
unfix fxnve
reset_timestep 0
</pre></div>
</div>
<ul class="simple">
<li><p><cite>unfix fxlan</cite> / <cite>unfix fxnve</cite>: Remove previous fixes.</p></li>
<li><p><cite>reset_timestep 0</cite>: Reset the step counter to 0.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>variable t equal step
variable steps equal 400000000
variable dt_thermo equal 1000000
variable dt_movie equal 10000000
</pre></div>
</div>
<ul class="simple">
<li><p><cite>variable t equal step</cite>: Convenience variable for the current timestep.</p></li>
<li><p><cite>variable steps equal 400000000</cite>: Production run length = 400 million steps.</p></li>
<li><p><cite>variable dt_thermo equal 1000000</cite>: Thermo output every 1 000 000 steps.</p></li>
<li><p><cite>variable dt_movie equal 10000000</cite>: Dump trajectory every 10 000 000 steps.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>group rxnSites type 1 3
fix CV_Rg all colvars N200_Rg_L300.colvars output ${fName}
</pre></div>
</div>
<ul class="simple">
<li><p><cite>group rxnSites type 1 3</cite>: Define group “rxnSites” containing atom types 1 &amp; 3.</p></li>
<li><p><cite>fix CV_Rg all colvars N200_Rg_L300.colvars output ${fName}</cite>: Attach Colvars using <cite>N200_Rg_L300.colvars</cite>, writing output prefixed by <cite>b70_N200_L300</cite>.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fix bondc rxnSites bond/create/random 20 1 3 12.72 3 prob 1 ${seed}
</pre></div>
</div>
<p>Every 20 steps, attempt to form a type 3 bond between atoms of type 1 &amp; 3 if separation ≤ 12.72 Å, with probability 1, seed = 14327.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fix bondbr rxnSites bond/break 20 3 12.72 prob 1 ${seed}
</pre></div>
</div>
<p>Every 20 steps, attempt to break existing type 3 bonds if length &gt; 12.72 Å, with probability 1.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>variable frmbnd equal f_bondc[2]
variable brkbnd equal f_bondbr[2]
fix saveBond all print ${dt_thermo} &quot;$t ${frmbnd} ${brkbnd}&quot; file BondData_${fName}.dat screen no
</pre></div>
</div>
<ul class="simple">
<li><p><cite>variable frmbnd equal f_bondc[2]</cite>: Number of bonds formed so far.</p></li>
<li><p><cite>variable brkbnd equal f_bondbr[2]</cite>: Number of bonds broken so far.</p></li>
<li><p><cite>fix saveBond all print ${dt_thermo} “$t ${frmbnd} ${brkbnd}” file BondData_b70_N200_L300.dat screen no</cite>: Write <cite>&lt;step&gt; &lt;formed&gt; &lt;broken&gt;</cite> every 1 000 000 steps.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>thermo_style    custom step epair pe ke ebond eangle temp bonds
thermo          ${dt_thermo}
fix saveThermo all print ${dt_thermo} &quot;$t $(temp) $(ke) $(pe) $(epair) $(ebond) $(eangle) $(bonds)&quot; file Thermo_${fName}.dat title &quot;# Steps Temp KinEng PotEng Epair Ebond Eangle Bonds&quot; screen no
</pre></div>
</div>
<ul class="simple">
<li><p><cite>thermo_style custom …</cite>: Select which quantities to print in thermo output.</p></li>
<li><p><cite>thermo ${dt_thermo}</cite>: Print thermo every 1 000 000 steps.</p></li>
<li><p><cite>fix saveThermo …</cite>: Write the same set (<cite>step temp ke pe epair ebond eangle bonds</cite>) to <cite>Thermo_b70_N200_L300.dat</cite>.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>############################ Langevin Dynamics ###############################
fix fxlan all langevin $T $T 500 ${seed}
fix fxnve all nve
</pre></div>
</div>
<p>Reapply Langevin + NVE for the production run after resetting the timestep.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>comm_style      tiled
fix fxbal all balance 1000 1.1 rcb
</pre></div>
</div>
<ul class="simple">
<li><p><cite>comm_style tiled</cite>: Use tiled communication for parallel performance.</p></li>
<li><p><cite>fix fxbal all balance 1000 1.1 rcb</cite>: Every 1000 steps, rebalance domains using recursive coordinate bisection.</p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>timestep 30
</pre></div>
</div>
<p>Switch to a 30 fs timestep for production dynamics.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>dump coor all custom ${dt_movie} traj_${fName}.dump id type mol mass x y z xu yu zu
</pre></div>
</div>
<p>Every 10 000 000 steps, write atom coordinates (ID, type, molecule ID, mass, x y z, xu yu zu) to <cite>traj_b70_N200_L300.dump</cite>.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>run ${steps}
write_restart final_state_${fName}.restart
</pre></div>
</div>
<ul class="simple">
<li><p><cite>run ${steps}</cite>: Execute the production run for 400 000 000 steps.</p></li>
<li><p><cite>write_restart final_state_b70_N200_L300.restart</cite>: At the end, write the final restart file.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pipeline.html" class="btn btn-neutral float-left" title="Pipeline Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="simulation_output.html" class="btn btn-neutral float-right" title="Simulation Output" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Aniruddha Chattaraj, David Kanovich.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>